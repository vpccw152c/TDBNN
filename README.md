# TDBNN
This is an implement of Triplet architecture based on Dynamic Bayesian Neural Network (TDBNN), a framework proposed in the paper "Learning Fine-grained Patient Similarity with Dynamic Bayesian Network Embedded Recurrent Neural Network".

As we can see from the title of the paper, TDBNN aims at learning fine-grained patient similarity based on Triplet architecture, DBN, and RNN making use of Electronic Healthcare Records (EHR) datasets. TDBNN firstly derives DBN from medical indicators to capture the causal correlations among different indicators in the form of conditional depedencies, then to overcome the constrain of conditional indenpence assumption and trainsmit the causal correlations as temporal features, and also to learn long-term memories contained in EHRs, the conditional dependencies in DBN are further employed to construct specially designed connections between GRU units in two adjacent time stamps in the RNN, where each indicator is represented by a RNN unit. Finally, RNNs with specially designed connections are employed as the fundamental components in the Triplet architecture for fine-grained patient similarity learning.

The framework is implemented in Pytorch. Codes in Auxiliary.py convert raw data from EHR to the format required by Med2Vec, a framwork which could obtain meaningful representations for medical events, and also the format required by TDBNN. Codes in SupervisedInformation.py calcuate the supervised patient similarity between patients for model training and triplet generation, the code also generate triplets of patients, which contains three patients with different similarity to each other. Codes in Triplet.py construct the TDBNN framework. More details could be found in the paper.
